# π“ μ„λ²„-ν΄λΌμ΄μ–ΈνΈ ν”„λ΅μ νΈ μ°Έμ΅° λ¬Έμ„

## π― ν”„λ΅μ νΈ κ°μ”
κ²μ„ μλ™ν™” κ΄€λ¦¬λ¥Ό μ„ν• μ‹¤μ‹κ°„ ν΄λΌμ΄μ–ΈνΈ λ¨λ‹ν„°λ§ μ‹μ¤ν…. μ—¬λ¬ κ²μ„ ν΄λΌμ΄μ–ΈνΈκ°€ μ¤‘μ•™ μ„λ²„λ΅ μƒνƒλ¥Ό λ³΄κ³ ν•κ³ , μ›Ή λ€μ‹λ³΄λ“λ¥Ό ν†µν•΄ μ‹κ°ν™” λ° INI νμΌλ΅ μ›κ²© λ…λ Ήμ„ μ‹¤ν–‰ν•λ” μ‹μ¤ν…μ…λ‹λ‹¤.

## π—οΈ μ‹μ¤ν… μ•„ν‚¤ν…μ²

### ν•µμ‹¬ κµ¬μ„±μ”μ†
- **TCP μ„λ²„** (`server.py`): ν¬νΈ 5050μ—μ„ ν΄λΌμ΄μ–ΈνΈ μƒνƒ λ°μ΄ν„° μμ‹ 
- **κ²μ„ ν΄λΌμ΄μ–ΈνΈ** (`client.py`): HTTP/TCPλ΅ μƒνƒ λ³΄κ³ , ν¬νΈ 6000μ—μ„ λ…λ Ή λ€κΈ°
- **μ›Ή λ€μ‹λ³΄λ“** (`board/app.py`): ν¬νΈ 8000μ Flask μ„λ²„λ΅ λ¨λ‹ν„°λ§ UI μ κ³µ
- **λ°μ΄ν„°λ² μ΄μ¤**: SQLite (`client_status.db`)μ— ν΄λΌμ΄μ–ΈνΈ μƒνƒ λ° μ΄λ ¥ μ €μ¥

### λ°μ΄ν„° νλ¦„
```
κ²μ„ ν΄λΌμ΄μ–ΈνΈ β†’ HTTP (ν¬νΈ 8123) β†’ TCP μ„λ²„ (ν¬νΈ 5050) β†’ SQLite DB
                β†‘                                           β†“
          λ…λ Ή μμ‹                                    μ›Ή λ€μ‹λ³΄λ“ (ν¬νΈ 8000)
          (ν¬νΈ 6000)                                      β†“
                β†‘                                    μ›Ή μΈν„°νμ΄μ¤
          INI λ…λ Ή β†β€•β€•β€•β€•β€•β€•β€•β€•β€•β€•β€•β€•β€•β€•β€•β€•β€•β€•β€•β€•β€•β€•β€•β€•β€•β€•β€•β€•β€•β€•β€•β€•
```

## π“ λ””λ ‰ν† λ¦¬ κµ¬μ΅°

```
π“¦ server_client_project1/
β”β”€β”€ π–¥οΈ server/               # λ©”μΈ TCP μ„λ²„
β”‚   β”β”€β”€ server.py            # ν•µμ‹¬ μ„λ²„ λ΅μ§ (ν¬νΈ 5050)
β”‚   β”β”€β”€ settings.json        # μ„λ²„ μ„¤μ •
β”‚   β””β”€β”€ client_status.db     # SQLite λ°μ΄ν„°λ² μ΄μ¤
β”β”€β”€ π‘¥ client/               # κ²μ„ ν΄λΌμ΄μ–ΈνΈ μ• ν”λ¦¬μΌ€μ΄μ…
β”‚   β”β”€β”€ client.py            # ν΄λΌμ΄μ–ΈνΈ μƒνƒ λ³΄κ³ κΈ°
β”‚   β””β”€β”€ config.json          # ν΄λΌμ΄μ–ΈνΈ μ„¤μ •
β”β”€β”€ π board/                # μ›Ή λ€μ‹λ³΄λ“ (Flask)
β”‚   β”β”€β”€ app.py               # Flask μ›Ή μ„λ²„ (ν¬νΈ 8000)
β”‚   β””β”€β”€ server_send.py       # INI λ…λ Ή μ „μ†΅κΈ°
β”β”€β”€ π¨ js/                   # λ¨λ“ν™”λ JavaScript
β”‚   β”β”€β”€ core/                # API, μƒνƒ, μ ν‹Έλ¦¬ν‹°
β”‚   β”β”€β”€ dashboard/           # μΉ΄λ“ κ΄€λ¦¬, ν•„ν„°
β”‚   β”β”€β”€ charts/              # λ°μ΄ν„° μ‹κ°ν™”
β”‚   β””β”€β”€ modals/              # λ…λ Ή μΈν„°νμ΄μ¤
β”β”€β”€ π¨ css/                  # μ¤νƒ€μΌμ‹νΈ
β””β”€β”€ π“„ index.html            # λ©”μΈ λ€μ‹λ³΄λ“ μΈν„°νμ΄μ¤
```

## π”‘ ν•µμ‹¬ νμΌ λ° μ—­ν• 

### μ„λ²„ κµ¬μ„±μ”μ†
- **`server/server.py`**: TCP λ¦¬μ¤λ„, λ°°μΉ DB μ‘μ—…, ν΄λΌμ΄μ–ΈνΈ μƒνƒ λ¨λ‹ν„°λ§
- **`server/settings.json`**: μ„λ²„ IP (172.30.101.232), ν¬νΈ, μ£ΌκΈ° μ„¤μ •
- **`server/client_status.db`**: ν…μ΄λΈ”: `clients`, `daily_dia`, `ini_commands`

### ν΄λΌμ΄μ–ΈνΈ κµ¬μ„±μ”μ†
- **`client/client.py`**: HTTP μ„λ²„ (8123), TCP λ…λ Ή μμ‹ κΈ° (6000), μ¤ν…”μ¤ λ¨λ“
- **`client/config.json`**: λ€μƒ ν”„λ΅μ„Έμ¤ (VM_Flow_*.exe), μ„λ²„ μ—”λ“ν¬μΈνΈ

### μ›Ή μΈν„°νμ΄μ¤
- **`board/app.py`**: REST API (/api/clients, /api/dia-history), INI λ…λ Ή μ „μ†΅
- **`index.html`**: λ“λκ·Έ-λ“λ΅­ μΉ΄λ“, ν•„ν„°, κ²€μƒ‰ κΈ°λ¥μ μ‹¤μ‹κ°„ λ€μ‹λ³΄λ“
- **`js/main.js`**: μ• ν”λ¦¬μΌ€μ΄μ… μ§„μ…μ , λ¨λ“ μ΄κΈ°ν™”

## π€ ν•µμ‹¬ κΈ°λ¥

### 1. μ‹¤μ‹κ°„ λ¨λ‹ν„°λ§
- IP, κ²μ„ μ„λ²„, λ‹¤μ΄μ•„λ¬λ“ μλ¥Ό ν‘μ‹ν•λ” ν΄λΌμ΄μ–ΈνΈ μƒνƒ μΉ΄λ“
- μλ™ μƒλ΅κ³ μΉ¨ (30μ΄-1μ‹κ°„ κ°„κ²©)
- μƒνƒ ν‘μ‹κΈ° λ° μ¤ν”„λΌμΈ κ°μ§€

### 2. λ°μ΄ν„° κ΄€λ¦¬
- λ™μ‹ μ ‘κ·Όμ„ μ„ν• WAL λ¨λ“μ SQLite
- μ„±λ¥μ„ μ„ν• λ°°μΉ μ²λ¦¬
- μΌμΌ λ‹¤μ΄μ•„λ¬λ“ μ΄λ ¥ μ¶”μ 

### 3. μ›κ²© μ μ–΄
- μ„ νƒλ ν΄λΌμ΄μ–ΈνΈμ— INI λ…λ Ή λ°°ν¬
- κ³µν†µ λ…λ Ήμ© ν…ν”λ¦Ώ μ‹μ¤ν…
- μ‹¤ν–‰ λ΅κΉ… λ° μƒνƒ μ¶”μ 

### 4. μ›Ή μΈν„°νμ΄μ¤
- μ •λ ¬/ν•„ν„°λ§ κ°€λ¥ν• ν΄λΌμ΄μ–ΈνΈ μΉ΄λ“
- λ‹¤μ΄μ•„λ¬λ“ μ λ²”μ„ ν•„ν„°λ§
- μ΄λ¦„/μ„λ²„λ΅ κ²€μƒ‰
- λ‹¤μ΄μ•„λ¬λ“ μ΄λ ¥ μ°¨νΈ μ‹κ°ν™”

## π” API μ—”λ“ν¬μΈνΈ

### λ€μ‹λ³΄λ“ API
- `GET /api/clients` - ν„μ¬ ν΄λΌμ΄μ–ΈνΈ μƒνƒ λ©λ΅
- `GET /api/dia-history?days=7` - λ‹¤μ΄μ•„λ¬λ“ μ΄λ ¥ λ°μ΄ν„°
- `GET /api/server-status` - μ„λ²„ μƒνƒ ν™•μΈ
- `POST /api/send-ini` - ν΄λΌμ΄μ–ΈνΈμ— INI λ…λ Ή μ „μ†΅
- `POST /api/start-server` - μ„λ²„ ν”„λ΅μ„Έμ¤ μ‹μ‘

### ν΄λΌμ΄μ–ΈνΈ HTTP μΈν„°νμ΄μ¤
- `GET /send?ip=X&name=Y&dia=Z&game=G&server=S&msg=M` - μƒνƒ μ—…λ°μ΄νΈ

## π’Ύ λ°μ΄ν„°λ² μ΄μ¤ μ¤ν‚¤λ§

### clients ν…μ΄λΈ”
```sql
name TEXT PRIMARY KEY, ip TEXT, game TEXT, server TEXT,
dia INTEGER, last_report TEXT, status TEXT, message TEXT
```

### daily_dia ν…μ΄λΈ”
```sql
date TEXT, name TEXT, ip TEXT, game TEXT, server TEXT,
dia INTEGER, status TEXT, message TEXT
PRIMARY KEY (date, name)
```

## β™οΈ μ¤‘μ” ν•¨μ

### μ„λ²„ (`server.py`)
- `handle_client()` - λ“¤μ–΄μ¤λ” ν΄λΌμ΄μ–ΈνΈ μ—°κ²° μ²λ¦¬
- `batch_processor()` - λ°±κ·ΈλΌμ΄λ“ DB λ°°μΉ μ‘μ—…
- `watch_ahk()` - ν΄λΌμ΄μ–ΈνΈ μƒνƒ λ¨λ‹ν„°λ§ (58μ΄ νƒ€μ„μ•„μ›ƒ)

### ν΄λΌμ΄μ–ΈνΈ (`client.py`)
- `send_to_server()` - λ©”μΈ μ„λ²„μ— μƒνƒ λ³΄κ³ 
- `CommandReceiver.run()` - INI λ…λ Ή μμ‹  λ€κΈ°
- `is_target_running()` - μ¤ν…”μ¤ λ¨λ“ ν”„λ΅μ„Έμ¤ κ°μ§€

### μ›Ή (`app.py`)
- `api_clients()` - μ‹¤μ‹κ°„ ν΄λΌμ΄μ–ΈνΈ λ°μ΄ν„° μ κ³µ
- `send_ini_command()` - λ΅κΉ…κ³Ό ν•¨κ» λ…λ Ή λ°°ν¬

## π› οΈ μΌλ°μ μΈ λ¬Έμ  λ° ν•΄κ²°μ±…

### μ—°κ²° λ¬Έμ 
- **μ„λ²„ μ—°κ²° λ¶κ°€**: IP 172.30.101.232, ν¬νΈ 5050/8000 ν™•μΈ
- **ν΄λΌμ΄μ–ΈνΈ λ³΄κ³  μ•λ¨**: config.json μ„λ²„ μ„¤μ • ν™•μΈ
- **λ°μ΄ν„°λ² μ΄μ¤ μ κΉ€**: μ„λ²„ μ¬μ‹μ‘ (WAL λ¨λ“κ°€ μ΄λ¥Ό λ°©μ§€ν•΄μ•Ό ν•¨)

### μ„±λ¥ λ¬Έμ 
- **λλ¦° λ€μ‹λ³΄λ“**: batch_processor() ν ν¬κΈ° ν™•μΈ
- **λ©”λ¨λ¦¬ μ‚¬μ©λ‰**: SQLite WAL νμΌ μ¦κ°€ λ¨λ‹ν„°λ§
- **μ—…λ°μ΄νΈ μ§€μ—°**: λ€μ‹λ³΄λ“ μƒλ΅κ³ μΉ¨ κ°„κ²© ν™•μΈ

## π“‹ μµκ·Ό μμ • μ‚¬ν•­ (2025λ…„ 1μ›”)

### μ£Όμ” λ²„κ·Έ μμ •
- **μΉ΄λ“ λ“λκ·Έμ•¤λ“λ΅­**: Sortable Swap ν”λ¬κ·ΈμΈ ν™μ„±ν™” (`swap: true`)λ΅ 2κ° μΉ΄λ“λ§ κµμ²΄
- **λΉ μΉ΄λ“ νΈμ§‘**: λ”λΈ”ν΄λ¦­μΌλ΅ ν…μ¤νΈ μ…λ ¥, localStorageμ— μλ™ μ €μ¥
- **μ¤„ μ²΄ν¬λ°•μ¤**: μ»¤μ¤ν…€ λ²νΈ ν‘μ‹ (01, 02, 03...) μ¤‘μ•™ μ •λ ¬
- **λ²νΈμ μ •λ ¬**: `autoSortByNumbers()` ν•¨μ λ³µκµ¬ - 320κ° μΉ΄λ“ μλ™ λ°°μΉ

## β οΈ μ¤‘μ” μ£Όμμ‚¬ν•­

### μΉ΄λ“ μ‹μ¤ν…
- **μ΄ μΉ΄λ“ μ**: 320κ° κ³ μ • (20μ—΄ Γ— 16ν–‰)
- **μ¤‘λ³µ μΉ΄λ“**: λ™μΌ λ²νΈλ” ν•λ‹¨μ— μλ™ λ°°μΉ
- **λΉ μΉ΄λ“**: `empty-μ«μ` ν•νƒλ΅ κ΄€λ¦¬
- **κ°„κ²°λ¨λ“/μ „μ²΄λ¨λ“**: μ „ν™ μ‹ λ μ΄μ•„μ›ƒκ³Ό μ²΄ν¬λ°•μ¤ μƒνƒ μ μ§€

### μ„±λ¥ μµμ ν™”
- `fetchClients()` νΈμ¶ μ‹ Sortable μ¬μ΄κΈ°ν™” μ£Όμ
- λ°°μΉ μ²λ¦¬λ΅ DB μ‘μ—… μµμ†ν™”
- 60μ΄λ§λ‹¤ μλ™ μƒλ΅κ³ μΉ¨ (κΈ°λ³Έκ°’)

## π“¦ JavaScript λ¨λ“ μƒμ„Έ κµ¬μ΅°

### Core λ¨λ“ (`js/core/`)
- **`api.js`**:
  - `fetchClients()` - ν΄λΌμ΄μ–ΈνΈ λ°μ΄ν„° κ°€μ Έμ¤κΈ° λ° UI λ λ”λ§
  - `sendIniCommand()` - INI λ…λ Ή μ „μ†΅
  - `checkServerStatus()` - μ„λ²„ μƒνƒ ν™•μΈ
  - Sortable.js λ“λκ·Έμ•¤λ“λ΅­ μ„¤μ •

- **`state.js`**:
  - μ „μ—­ μƒνƒ κ΄€λ¦¬ (condensed, refreshInterval, clientOrder)
  - localStorage μ—°λ™

- **`utils.js`**:
  - μ ν‹Έλ¦¬ν‹° ν•¨μ (debounce, formatDate, trimTimestamp)

### Dashboard λ¨λ“ (`js/dashboard/`)
- **`cards.js`**:
  - `autoSortByNumbers()` - λ²νΈμ μλ™ μ •λ ¬
  - `deleteCard()` - λΉ μΉ΄λ“ μ‚­μ 
  - `toggleCardSelection()` - μΉ΄λ“ μ„ νƒ/ν•΄μ 
  - `toggleRowSelection()` - μ¤„ λ‹¨μ„ μ„ νƒ

- **`filters.js`**:
  - `applyFilters()` - κ²€μƒ‰ λ° ν•„ν„° μ μ©
  - `filterByDiaRange()` - λ‹¤μ΄μ•„ λ²”μ„ ν•„ν„°

### Modals λ¨λ“ (`js/modals/`)
- **`ini-command.js`**:
  - `openCommandModal()` - INI λ…λ Ή λ¨λ‹¬ μ—΄κΈ°
  - `loadTemplate()` - ν…ν”λ¦Ώ λ¶λ¬μ¤κΈ°
  - `saveCustomTemplate()` - μ»¤μ¤ν…€ ν…ν”λ¦Ώ μ €μ¥

## π§ μ£Όμ” κΈ°λ¥ ν…μ¤νΈ μ²΄ν¬λ¦¬μ¤νΈ

### μΉ΄λ“ λ“λκ·Έμ•¤λ“λ΅­
β… μΆμ° λ“λκ·Έ μ‹ 2κ°λ§ κµμ²΄
β… μƒν• λ“λκ·Έ μ‹ 2κ°λ§ κµμ²΄
β… μ¤‘κ°„ μΉ΄λ“λ“¤μ΄ λ°€λ¦¬μ§€ μ•μ

### λΉ μΉ΄λ“ νΈμ§‘
β… λ”λΈ”ν΄λ¦­μΌλ΅ νΈμ§‘ λ¨λ“ μ§„μ…
β… Enterλ΅ μ €μ¥, Escλ΅ μ·¨μ†
β… μƒλ΅κ³ μΉ¨ ν›„μ—λ„ ν…μ¤νΈ μ μ§€
β… μ‚­μ  λ²„νΌμΌλ΅ μ™„μ „ μ κ±°

### λ²νΈμ μ •λ ¬
β… 320κ° μΉ΄λ“ μ •ν™•ν λ°°μΉ
β… μ¤‘λ³µ λ²νΈλ” ν•λ‹¨ μ¶”κ°€
β… λΉ μΉ΄λ“ μλ™ μƒμ„±

### INI λ…λ Ή μ „μ†΅
β… μ²΄ν¬λ μΉ΄λ“λ§ μ„ νƒ
β… μ¤„ μ²΄ν¬λ°•μ¤λ΅ 20κ°μ”© μ„ νƒ
β… ν…ν”λ¦Ώ μ €μ¥/λ¶λ¬μ¤κΈ°
β… μ „μ†΅ λ΅κ·Έ ν™•μΈ

## π”§ λ””λ²„κΉ… ν

### μ½μ†” λ…λ Ήμ–΄
```javascript
// ν„μ¬ μƒνƒ ν™•μΈ
dashboardDebug.getState()

// λ¨λ“ λ΅λ“ ν™•μΈ
dashboardDebug.showModuleInfo()

// μ„¤μ • μ΄κΈ°ν™”
dashboardDebug.resetSettings()
```

### λ¬Έμ  ν•΄κ²°
- **μΉ΄λ“κ°€ μ• λ³΄μ„**: `fetchClients()` μ½μ†”μ—μ„ μ‹¤ν–‰
- **λ“λκ·Έ μ•λ¨**: Sortable.swap.min.js λ΅λ“ ν™•μΈ
- **λΉ μΉ΄λ“ ν…μ¤νΈ μ‚¬λΌμ§**: localStorage ν™•μΈ
- **μ¤„ μ²΄ν¬λ°•μ¤ μ–΄κΈ‹λ‚¨**: κ°„κ²°λ¨λ“ ν† κΈ€ ν›„ μ¬ν™•μΈ

## π€ λΉ λ¥Έ λ…λ Ήμ–΄

### μ‹μ¤ν… μ‹μ‘
```bash
# ν„°λ―Έλ„ 1: λ©”μΈ μ„λ²„ μ‹μ‘
cd server && python server.py

# ν„°λ―Έλ„ 2: μ›Ή λ€μ‹λ³΄λ“ μ‹μ‘
cd board && python app.py

# ν„°λ―Έλ„ 3: ν΄λΌμ΄μ–ΈνΈ μ‹μ‘ (κ° λ¨Έμ‹ μ—μ„)
cd client && python client.py
```

### λ°μ΄ν„°λ² μ΄μ¤ μ ‘κ·Ό
```bash
# ν„μ¬ ν΄λΌμ΄μ–ΈνΈ λ³΄κΈ°
sqlite3 server/client_status.db "SELECT * FROM clients"

# μΌμΌ μ΄λ ¥ ν™•μΈ
sqlite3 server/client_status.db "SELECT * FROM daily_dia WHERE date = date('now')"

# INI λ…λ Ή λ΅κ·Έ ν™•μΈ
sqlite3 server/client_status.db "SELECT * FROM ini_commands ORDER BY timestamp DESC LIMIT 10"
```

### μ„¤μ •
- **μ„λ²„ IP**: `server/settings.json`κ³Ό `client/config.json` μμ •
- **ν¬νΈ**: μ„λ²„(5050), μ›Ή(8000), ν΄λΌμ΄μ–ΈνΈ-HTTP(8123), ν΄λΌμ΄μ–ΈνΈ-CMD(6000)
- **λ€μƒ**: `client/config.json` targets λ°°μ—΄μ— ν”„λ΅μ„Έμ¤ μ΄λ¦„ μ¶”κ°€

## π“ κ°λ° κ·μΉ™

### μ½”λ“ μμ • μ‹
1. κΈ°μ΅΄ μ½”λ“ μ¤νƒ€μΌ μ μ§€
2. μ£Όμ„μ€ ν•κΈ€λ΅ μ‘μ„±
3. μ½μ†” λ΅κ·Έλ” μ΄λ¨μ§€ ν™μ© (β…, β, β οΈ, π“)
4. localStorage ν‚¤λ” camelCase μ‚¬μ©

### Git μ»¤λ°‹ λ©”μ‹μ§€
```
fix: μΉ΄λ“ λ“λκ·Έμ•¤λ“λ΅­ μ¤μ™‘ λ¬Έμ  μμ •
feat: λΉ μΉ΄λ“ νΈμ§‘ κΈ°λ¥ μ¶”κ°€
refactor: API λ¨λ“ κµ¬μ΅° κ°μ„ 
```

---
*AI μ–΄μ‹μ¤ν„΄νΈ μ°Έμ΅°μ© μƒμ„± - ν•„μ ν”„λ΅μ νΈ νƒμƒ‰ μ •λ³΄ ν¬ν•¨*
*λ§μ§€λ§‰ μ—…λ°μ΄νΈ: 2025λ…„ 1μ›”*